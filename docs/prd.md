## 얼굴 인식 미니게임 앱 ― MVP PRD

### (작성일: 2025-08-06)

---

### 1. 배경 & 문제 정의

- **Reels/TikTok 필터형 게임**이 유행하지만 Flutter로 간단히 시작할 수 있는 오픈소스 예제가 부족함.
- 솔로 개발자(1 인)가 **평일 하루 6 시간** 안배로 2 주 이내 프로토타입을 완성하고, **사이드 수익화 가능성**을 검증하고자 함.

---

### 2. 제품 목표 (MVP)

| 구분          | 목표                                                                                                                              |
| ------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| **제품 목표** | ① 얼굴을 카메라에 비추면 자동으로 인식<br>② “입을 벌려 풍선을 터뜨려 점수 얻기” 단일 게임 제공                                    |
| **성공 기준** | _D + 14_ 안드로이드 TestFlight/내부 배포<br>– 평균 인식 지연 ≤ 120 ms<br>– 1 회 세션 당 게임 성공/실패 로직 정상 동작률 98 % 이상 |
| **지표**      | • Session 시작-완료 비율 ≥ 70 %<br>• 평균 세션 길이 ≥ 30 s                                                                        |

---

### 3. 대상 사용자(Persona)

- **Z세대·MZ세대**: 짧고 직관적인 AR 필터형 게임을 즐기는 틱톡/인스타 릴스 사용자
- **커피-브레이크 유저**: 설치 부담 없이 1-2 분 짜리 미니게임 선호

---

### 4. 범위 (MVP 스코프)

| 포함(✅)                          | 제외(❌)                       |
| --------------------------------- | ------------------------------ |
| 프론트 카메라 얼굴 인식 (1 명)    | 후면 카메라, 다중 얼굴         |
| “입 벌려 풍선 터뜨리기” 1 종 게임 | 복수 게임 모드/스킨            |
| 점수 계산 & 즉시 UI 표시          | 글로벌 랭킹·친구 초대          |
| 기본 광학 미러링, 한글/영문 UI    | 다국어 5 개 이상, AR 3D 마스크 |
| 로컬(디바이스) 점수 저장          | 서버 연동(리더보드), 광고/결제 |
| 게임 화면 녹화 & SNS 공유         | 실시간 스트리밍, 클라우드 저장 |

---

### 5. 핵심 기능 요구사항

| #   | 기능                | 설명                                                              | 우선순위 |
| --- | ------------------- | ----------------------------------------------------------------- | -------- |
| F-1 | 실시간 얼굴 검출    | 30 fps 이상으로 bounding box 획득                                 | Must     |
| F-2 | 입 닫힘 이벤트 감지 | `upperLipTop`-`lowerLipBottom` Landmark 거리: 열림→닫힘 전환 시 해당 입술 위치 기준으로 _POP_ | Must     |
| F-3 | 게임 로직           | 15 초 타이머 동안 풍선 10개 랜덤 위치 생성, 입 닫는 순간 해당 위치 근처 풍선 터짐·점수 +1  | Must     |
| F-4 | 점수 UI             | 실시간 점수·잔여 시간 표시 후 “축하/실패” 결과 화면               | Must     |
| F-5 | 설정 화면           | 인식 감도(Threshold)·사운드 On/Off                                | Should   |
| F-6 | 앱 권한 처리        | 첫 실행 시 카메라 권한 요청 → 거부 시 안내                        | Must     |
| F-7 | 게임 화면 녹화      | 게임 시작~결과까지 15초 영상 녹화 → 결과 화면에서 재생/미리보기 → 사용자 선택 시 저장 | Must     |
| F-8 | 저장소 권한 처리    | 사용자가 "저장하기" 선택 시에만 외부 저장소 권한 요청             | Must     |

---

### 6. 비-기능 요구사항

| 항목              | 목표                                                  |
| ----------------- | ----------------------------------------------------- |
| **성능**          | • 얼굴 인식 지연: ≤ 100ms (Pixel 5 기준)<br>• 메모리: ≤ 300MB (피크, 녹화 포함)<br>• FPS: ≥ 30fps (게임 중), 60fps (녹화)<br>• 앱 실행: < 3초 (콜드 스타트)<br>• 녹화 품질: 1080p@60fps, H.264 코덱 |
| **UX**            | • 3-tap 내 게임 시작<br>• 접근성: WCAG 2.1 AA 준수<br>• 다국어: 한국어, 영어 지원 |
| **안정성**        | • 크래시율 < 1% (Firebase Crashlytics)<br>• ANR율 < 0.1%<br>• 네트워크 오프라인 동작 |
| **보안/개인정보** | • 얼굴 데이터 로컬 처리만<br>• GDPR/개인정보보호법 준수<br>• Privacy Policy 필수 표시<br>• 데이터 수집 최소화 원칙<br>• 녹화 영상 로컬 저장만 (클라우드 업로드 없음) |
| **배포 대상**     | • Android 8.0+ (API 26+)<br>• iOS 15+ (내부 테스트)<br>• 테스트 기기: Pixel 5, Galaxy S21, iPhone 12 |

---

### 7. 사용자 흐름

1. **앱 실행** → 로고 스플래시(≤ 1 s)
2. **카메라 권한 요청** → 승인 시 미리보기 화면
3. **사용자 얼굴 인식** → 프레임 당 입 벌림 여부 체크
4. **게임 시작 버튼** 터치
5. **15 초 게임**

   - 풍선 Sprite 10개 랜덤 위치 표시
   - 입을 벌렸다가 닫을 때마다 입 위치 근처 풍선 POP → 점수+1, 사운드

6. **결과 화면** (점수·이모지 애니메이션)
7. **녹화 영상 미리보기** → 게임 플레이 영상 자동 재생
8. **저장/공유 선택**
   - "저장하기" 버튼 → 갤러리 저장 + 성공 알림
   - "공유하기" 버튼 → SNS 직접 공유 (틱톡, 인스타 등)
   - "건너뛰기" 버튼 → 영상 삭제하고 다음 단계
9. **다시하기 / 종료** 선택

---

### 8. 기술 스택

| 레이어          | 라이브러리/툴                        | 비고                   |
| --------------- | ------------------------------------ | ---------------------- |
| **플랫폼**      | Flutter 3.32.4+                      | Cross-platform         |
| **카메라**      | `camera` ^0.11.2                     | 프론트 카메라          |
| **ML**          | `google_mlkit_face_detection` ^0.13.1| FAST 모드, Contours ON |
| **게임 렌더링** | `flame` ^1.30.1                      | 2D Sprite & Timer      |
| **상태관리**    | `riverpod` ^2.6.1                    | 간단한 상태·DI         |
| **분석/Crash**  | Firebase Analytics / Crashlytics     | MVP 단계 필수          |
| **화면 녹화**   | `flutter_screen_recording` ^2.1.0    | 게임 플레이 녹화       |
| **SNS 공유**    | `share_plus` ^7.2.2                  | 틱톡, 인스타 등 공유   |
| **권한 관리**   | `permission_handler` ^11.0.1         | 카메라/저장소 권한     |
| **성능 모니터링** | `flutter_performance_tools`        | 실시간 성능 추적       |

---

### 9. 일정 (3-4 주 스프린트)

#### Phase 1: 기반 구축 (Week 1)
| Day   | 작업                                     | 산출물              | 검증 기준 |
| ----- | ---------------------------------------- | ------------------- | --------- |
| 1-2   | 프로젝트 세팅, 아키텍처 설계             | Git repo, 기본 구조 | 빌드 성공 |
| 3-4   | 카메라 미리보기, 권한 처리               | 카메라 화면         | 권한 흐름 정상 |
| 5-7   | ML Kit 연동, 얼굴·입 Landmark 추출       | Demo 화면           | 얼굴 인식률 >90% |

#### Phase 2: 핵심 기능 (Week 2)  
| Day   | 작업                                     | 산출물              | 검증 기준 |
| ----- | ---------------------------------------- | ------------------- | --------- |
8-10   | Flame 게임 씬 구현, 풍선 POP 로직        | 게임 모듈           | 게임 로직 완료 |
| 11-12 | UI/UX 구현, 사운드·애니메이션            | Beta build v0.1     | UX 흐름 검증 |
| 13-14 | 성능 최적화, 메모리 누수 점검            | Beta build v0.2     | 성능 기준 달성 |

#### Phase 3: 안정화 (Week 3)
| Day   | 작업                                     | 산출물              | 검증 기준 |
| ----- | ---------------------------------------- | ------------------- | --------- |
| 15-17 | 다기기 테스트, 호환성 확인               | QA Report           | 5개 기기 테스트 |
| 18-19 | 버그 수정, Crashlytics/Analytics 통합    | RC build v0.9       | 크래시율 <1% |
| 20-21 | 최종 검수, 스토어 준비                   | Release Candidate   | 출시 준비 완료 |

---

### 10. 위험 & 대응

| 위험                    | 확률 | 영향             | 대응 전략                            | 완화 방안 |
| ----------------------- | ---- | ---------------- | ------------------------------------ | --------- |
| 얼굴 인식 지연 ↑        | 높음 | 게임 플로우 끊김 | 해상도 720p↓, Isolate 처리           | 성능 모니터링 대시보드 |
| 다중 기기 호환성        | 중간 | 권한/카메라 실패 | Firebase Test Lab 5+ 기기 자동 테스트| 디바이스별 테스트 매트릭스 |
| 혼잡 배경에서 인식 오류 | 중간 | 게임 실패율 ↑    | Threshold 조정 옵션, 안내 메시지     | A/B 테스트로 최적값 찾기 |
| **메모리 누수**         | 중간 | **앱 크래시**    | **메모리 프로파일링, 정기 GC**       | **리소스 해제 체크리스트** |
| **개인정보 규제**       | 낮음 | **출시 차단**    | **법무팀 검토, Privacy Policy**      | **GDPR 준수 체크리스트** |
| **iOS 출시 지연**       | 높음 | **매출 기회손실**| **Android 먼저 검증 후 iOS 진행**    | **단계별 출시 전략** |

---

### 11. 향후 로드맵 (MVP 이후)

1. **리더보드**: Supabase + Row Level Security
2. **여러 미니게임 추가**: 눈깜빡임, 고개 흔들기
3. **AR 3D 마스크 & 스킨 샵** (IAP)
4. **SNS 공유 / 딥링크 챌린지**
5. **광고·구독 기반 수익화**

---

### 12. 오픈 이슈

| 질문                     | 필요 의사결정 시점       |
| ------------------------ | ------------------------ |
| iOS App Store 진출 여부? | MVP 결과 지표 달성 후    |
| 광고 vs. 구독 모델?      | 게임 수명·리텐션 확인 후 |

---

### 13. 품질 보증 & 테스트 전략

#### 성능 테스트
- **지연 측정**: ML Kit 추론 시간 → UI 업데이트까지 end-to-end 측정
- **메모리 프로파일링**: DevTools Memory tab으로 10분 세션 동안 누수 체크
- **FPS 모니터링**: Flutter Performance overlay로 실시간 측정

#### 기능 테스트 
- **자동화**: Widget test 커버리지 ≥ 80%
- **수동**: 다양한 조명 환경(실내/실외/어두운 곳) 테스트
- **접근성**: TalkBack/VoiceOver 호환성 검증

#### 디바이스 호환성
- **1차**: Pixel 5, Galaxy S21, iPhone 12 (핵심 3기종)  
- **2차**: Firebase Test Lab 10개 기종 자동화
- **3차**: 저사양 기기 1종 추가 (성능 하한선 확인)

---

### 14. 성과 측정 & 분석

#### 기술 지표 (DevOps)
```yaml
성능_임계값:
  얼굴_인식_지연: 100ms  # p95 기준
  메모리_사용량: 250MB   # 피크 기준  
  크래시율: 1%          # DAU 기준
  앱_실행_시간: 3초      # 콜드 스타트
```

#### 사용자 지표 (Analytics)
```yaml
핵심_KPI:
  세션_완료율: 70%      # 게임 시작 → 결과까지
  평균_세션_길이: 30초   # 1회 게임 플레이
  재방문율: 40%         # D1 retention
  추천_지수: 7.0        # NPS 점수
```

---

**결론**: 이 PRD를 기준으로 **3-4주 내 MVP**를 출시, 주요 지표(성능·사용성·안정성)를 검증한다. 성공 시 게임 모드 확장·수익화로 단계적 고도화를 진행한다.
